

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Breadfast - Food Aggregation KB</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; font-family: 'Inter', sans-serif; background: #e0f5e9; color: #111; }

    .app {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 20px;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .sidebar {
      background: #fff;
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 6px 18px rgba(22,27,40,0.06);
    }

    .logo { display: flex; align-items: center; gap: 12px; }
    .logo img { width: 48px; height: 48px; border-radius: 8px; }
    .brand { font-weight: 700; font-size: 18px; color: #d6007d; }
    .tagline { font-family: 'Poppins', sans-serif; font-size: 14px; color: #000; margin-top: 4px; }

    .sidebar-search {
      margin: 14px 0;
    }
    .sidebar-search input {
      width: 100%;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    .section-title {
      font-weight: 700; margin: 10px 0; color: #243244;
      cursor: pointer; display: flex; justify-content: space-between; align-items: center;
    }
    .section-title .arrow { transition: transform 0.3s ease-in-out; }

    .categories, .complaints, .numbers, .processes {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease-in-out, padding 0.3s ease-in-out;
      padding-left: 0;
    }
    .categories.open, .complaints.open, .numbers.open, .processes.open { padding-left: 5px; }

    .cat, .comp, .num, .proc {
      padding: 8px 10px; border-radius: 8px; cursor: pointer;
      border: 1px solid transparent; transition: 0.2s;
    }
    .cat:hover, .comp:hover, .num:hover, .proc:hover { background:#f9f1f7; }
    .cat.active, .comp.active, .num.active, .proc.active { background:#fbe8f3; border-color:#f3cce1; }

    .viewer {
      background:#fff; padding:18px; border-radius:12px;
      box-shadow:0 6px 18px rgba(22,27,40,0.06);
      overflow-y:auto;
    }
    .viewer h1 { font-size:20px; margin-bottom:12px; color:#c2187b; }

    .case-list{display:flex;flex-direction:column;gap:12px;}
    .case-card{background:#fff;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.05);transition:all 0.3s ease;overflow:hidden;}
    .case-header{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;cursor:pointer;font-weight:600;color:#c2187b; border-left: 5px solid transparent;}
    .case-header:hover{background:#fdf1f7;}
    .case-header-title { display: flex; align-items: center; gap: 10px; flex-wrap: wrap;}
    .arrow{transition:transform 0.3s ease-in-out;}
    .case-card.open .arrow{transform:rotate(90deg);}

    .case-body { max-height:0; overflow:hidden; transition:max-height 0.5s ease-in-out, padding 0.3s ease-in-out; }
    .case-card.open .case-body { max-height:1500px; padding-bottom:10px; }
    
    .dropdown{border-top:1px solid #eee;}
    .dropdown-header{padding:12px 16px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-weight:700;}
    .dropdown-header:hover{background:#f6f6f6;}
    .dropdown-arrow{transition:transform 0.3s ease-in-out;}
    .dropdown-body{max-height:0;overflow:hidden;padding:0 16px;transition:max-height 0.5s ease-in-out, padding 0.3s ease-in-out;line-height:1.6;}
    .dropdown.open .dropdown-body{max-height:500px;padding:12px 16px;}
    .dropdown.open .dropdown-arrow{transform:rotate(90deg);}
    .dropdown-body h3 { margin: 10px 0 5px; color: #111; }
    .viewer-search-bar {
  margin-bottom: 15px;
}
.viewer-search-bar input {
  width: 100%;
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 14px;
}

    /* --- Visual Enhancements --- */
    .case-header.urgency-medium { border-left-color: #ffc107; }
    .case-header.urgency-high, .case-header.urgency-urgent { border-left-color: #dc3545; }
    
    .case-tag {
      padding: 3px 10px;
      font-size: 11px;
      border-radius: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: white;
      margin-top: 4px;
    }
    .case-tag.type-delay { background-color: #ffc107; color: #333; }
    .case-tag.type-technical { background-color: #007bff; }
    .case-tag.type-unreachable { background-color: #fd7e14; }
    .case-tag.type-out-of-zone { background-color: #6f42c1; }
    .case-tag.type-restaurant-delay-while-dispatch { background-color: #20c997; }
    .case-tag.type-order-package-messy { background-color: #e83e8c; }
    .case-tag.type-customer-refuses-to-receive { background-color: #dc3545; }
    .case-tag.type-close-by-0 { background-color: #343a40; }
    .case-tag.type-customer-inappropriate-attitude { background-color: #8b0000; }
    .case-tag.type-customer-requests-to-be-called-by-cx { background-color: #17a2b8; }
    .case-tag.type-customer-requests-cancellation-while-en-route { background-color: #ff6347; }
    .case-tag.type-bike-breakdown { background-color: #708090; }
    .case-tag.type-da-request { background-color: #007bff; }
    .case-tag.type-da-is-late-for-pick-up { background-color: #fd7e14; }
    .case-tag.type-da-refused-to-receive-order { background-color: #6f42c1; }
    .case-tag.type-electricity-issue { background-color: #ffc107; color: #212529; }
    .case-tag.type-internet-issue { background-color: #007bff; }
    .case-tag.type-kitchen-maintenance { background-color: #5a6268; }
    .case-tag.type-system-crash { background-color: #c82333; }
    .case-tag.type-can-be-replaced { background-color: #28a745; }
    .case-tag.type-duplicate-order { background-color: #4b0082; }
    .case-tag.type-with-the-restaurant { background-color: #a0522d; }
    .case-tag.type-da-misuse-of-food { background-color: #800000; }
    .case-tag.type-pricing-issue-or-description-or-photo { background-color: #6c757d; }
    .case-tag.type-rider-picked-up-wrong-order { background-color: #fd7e14; }
    /* --- End Visual Enhancements --- */

    .comp-table {
      width: 100%; border-collapse: separate; border-spacing: 0; background: #fff;
      border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); overflow: hidden;
      transition: all 0.3s ease; font-size: 14px;
    }
    .comp-table thead { background: #7d147d; color: #fff; }
    .comp-table th, .comp-table td { padding: 14px 18px; text-align: left; vertical-align: middle; transition: background 0.3s ease; }
    .comp-table tbody tr { border-bottom: 1px solid #eee; }
    .comp-table tbody tr:hover { background: #f3e8f9; }
    .badge { display: inline-block; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; }
    .badge.refund { background: #e6f0ff; color: #004085; }
    .badge.replacement { background: #e8f8f2; color: #155724; }
    .badge.fixed { background: #fff3cd; color: #856404; }
    .category { display: inline-block; background: #000; color: #fff; font-weight: bold; border-radius: 20px; padding: 5px 12px; font-size: 12px; text-align: center; }
    .note { font-size: 13px; color: #555; }
    
    /* Styles for Document View */
    .document-view h2 {
        font-size: 18px;
        color: #c2187b;
        border-bottom: 2px solid #fbe8f3;
        padding-bottom: 8px;
        margin-top: 20px;
        margin-bottom: 16px;
    }
    .document-view h2:first-child {
        margin-top: 0;
    }
    .document-view h3 {
        font-size: 16px;
        font-weight: 700;
        margin-top: 16px;
        margin-bottom: 8px;
    }
    .document-view ul, .document-view ol {
        padding-left: 25px;
        margin-bottom: 12px;
        line-height: 1.7;
    }
    .document-view li {
        margin-bottom: 6px;
    }
    .document-view p {
        line-height: 1.7;
        margin-bottom: 10px;
    }
    .document-view .sms-box {
        background-color: #f1f3f5;
        border-left: 4px solid #007bff;
        padding: 12px;
        margin: 16px 0;
        font-style: italic;
        border-radius: 4px;
    }

    /* Styles for policy table */
    .comp-policy-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 25px;
        border: 1px solid #eee;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .comp-policy-table th, .comp-policy-table td {
        padding: 14px 18px;
        text-align: left;
        border-bottom: 1px solid #eee;
    }
    .comp-policy-table tbody tr:last-child td {
        border-bottom: none;
    }
    .comp-policy-table th {
        background-color: #f8f9fa;
        font-weight: 700;
    }
    .comp-policy-table td:last-child {
        text-align: center;
    }
    .badge-percent {
        background-color: #7d147d;
        color: white;
        padding: 6px 14px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 13px;
        display: inline-block;
    }
    .badge-full-refund {
        background-color: #dc3545;
        color: white;
        padding: 6px 14px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 13px;
        display: inline-block;
    }
  
/* --- Products Custom Card Styles --- */
.product-card {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  padding: 16px;
  margin-bottom: 18px;
  transition: 0.3s;
}
.product-card:hover { transform: translateY(-3px); }
.product-card h3 { font-size: 16px; margin: 0; color: #243244; }
.product-tag {
  display: inline-block;
  background: #007bff;
  color: #fff;
  font-size: 12px;
  font-weight: 600;
  padding: 4px 10px;
  border-radius: 12px;
  margin: 4px 0;
}
.product-desc { font-size: 14px; color: #555; margin: 6px 0 14px; }
.product-card button {
  width: 100%;
  background: #800080;
  color: #fff;
  border: none;
  padding: 10px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
}
.product-card button:hover { background: #660066; }

/* Modal */
.modal {
  display: none; 
  position: fixed; 
  z-index: 999; 
  left: 0; top: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  justify-content: center; align-items: center;
}
.modal-content {
  background: #fff;
  border-radius: 12px;
  width: 500px;
  max-width: 95%;
  overflow: hidden;
}
.modal-header {
  background: #800080;
  color: #fff;
  padding: 12px 16px;
  display: flex; justify-content: space-between; align-items: center;
}
.modal-body { padding: 16px; font-size: 14px; color: #333; }
.modal-body h4 { margin-top: 16px; margin-bottom: 8px; color: #800080; }
.modal-close { cursor: pointer; font-size: 18px; }


/* --- Products Card V2 (Icon + Urgency Badge) --- */
.product-card {
  position: relative;
  background: #fff;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  transition: transform .3s ease, box-shadow .3s ease;
  padding: 18px;
  margin-bottom: 20px;
}
.product-card:hover { 
  transform: translateY(-6px); 
  box-shadow: 0 6px 16px rgba(0,0,0,0.15);
}

.product-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}
.product-card h3 {
  font-size: 18px;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}
.product-card h3 .icon {
  font-size: 20px;
}
.urgency-badge {
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 8px;
  font-weight: bold;
}
.urgent { background: #ff4d4d; color: #fff; }
.medium { background: #ffcc00; color: #333; }
.normal { background: #28a745; color: #fff; }

.product-tag {
  display: inline-block;
  background: #007bff;
  color: #fff;
  font-size: 12px;
  font-weight: 600;
  padding: 4px 10px;
  border-radius: 12px;
  margin: 4px 0 10px;
}

.product-desc { font-size: 14px; color: #555; margin: 0 0 14px; }

.product-card button {
  background: #800080;
  color: #fff;
  border: none;
  padding: 8px 14px;
  border-radius: 6px;
  font-weight: bold;
  font-size: 13px;
  cursor: pointer;
  transition: background .3s ease;
}
.product-card button:hover { background: #660066; }

</style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="logo">
        <img src="logo.png" alt="Breadfast Logo">
        <div>
          <div class="brand">Breadfast - Food Aggregation KB</div>
          <div class="tagline">From Bread To Everything</div>
        </div>
      </div>

      <div class="sidebar-search">
        <input type="text" id="sidebarSearch" placeholder="Search...">
      </div>

      <div>
        <div class="section-title" id="catToggle">Categories <span class="arrow">▶</span></div>
        <div class="categories" id="categories">
          <div class="cat" data-cat="rider">Rider Support</div>
          <div class="cat" data-cat="restaurant">Restaurant Support</div>
          <div class="cat" data-cat="outbound" data-render-type="document">Outbound Team</div>
          <div class="cat" data-cat="chat">Customer Requests</div>
          <div class="cat" data-cat="nps" data-render-type="document">NPS</div>
        </div>
      </div>

      <div>
        <div class="section-title" id="compToggle">Complaints <span class="arrow">▶</span></div>
        <div class="complaints" id="complaints">
          <div class="comp" data-comp="products">Products</div>
          <div class="comp" data-comp="delivery">Delivery</div>
          <div class="comp" data-comp="packaging">Packaging</div>
          <div class="comp" data-comp="coffee">Coffee</div>
        </div>
      </div>
      
      <div>
        <div class="section-title" id="numToggle">Restaurants Numbers <span class="arrow">▶</span></div>
        <div class="numbers" id="numbersBox">
          <div class="num" data-num="all_numbers">Numbers</div>
        </div>
      </div>
      
      <div>
        <div class="section-title" id="compProcessToggle">Compensation Process <span class="arrow">▶</span></div>
        <div class="processes" id="CompensationProcessBox">
          <div class="proc" data-proc="main_process">Process</div>
        </div>
      </div>
    </aside>

    <main class="viewer">
      <h1 id="viewerTitle">Select a category or complaint to view cases</h1>
      <div id="viewerContent" class="content muted">Results will appear here once you select a category or search.</div>
    </main>
  </div>

  <script>
    const categories = document.querySelectorAll('.cat');
    const complaints = document.querySelectorAll('.comp');
    const numbers = document.querySelectorAll('.num');
    const processes = document.querySelectorAll('.proc');
    const viewerContent = document.getElementById('viewerContent');
    const viewerTitle = document.getElementById('viewerTitle');

    const demoCases = {

  products: [
    {
      case: "Bad Quality Food",
      type: "Food Quality",
      urgency: "urgent",
      description: "Customer complains about undercooked, overcooked, or spoiled food.",
      cx: "1. Apologize to the customer.<br>2. Request photo evidence.<br>3. Apply compensation policy (refund).",
      tree: "Products → Bad Quality Food",
      treeCx: "100% refund + Delivery Fees"
    },
    {
      case: "Wrong Packaging",
      type: "Packaging Issue",
      urgency: "medium",
      description: "Customer received order with messy or wrong packaging.",
      cx: "1. Apologize to the customer.<br>2. Confirm order details.<br>3. Apply compensation (replacement or refund).",
      tree: "Products → Wrong Packaging",
      treeCx: "Replacement OR Refund"
    }
  ],

  chat: [
  {
    case: "Late Order Complaint",
    type: "Delay",
    urgency: "medium",
    description: "Customer reports that the order is late beyond the ETA.",
    cx: "1. Apologize to the customer.<br>2. Check DA status in Yelo.<br>3. Provide an ETA and offer compensation if delay is confirmed.",
    tree: "Customer Requests → Late Order",
    treeCx: "Customer informed + compensation applied"
  },
  {
    case: "Wrong Item Delivered",
    type: "Order Issue",
    urgency: "urgent",
    description: "Customer received a wrong dish or missing items.",
    cx: "1. Apologize and confirm order ID.<br>2. Create a ticket.<br>3. Offer replacement or refund.<br>4. Escalate to restaurant if needed.",
    tree: "Customer Requests → Wrong Item",
    treeCx: "Replacement or Refund processed"
  },
  {
    case: "Request for Refund",
    type: "Compensation",
    urgency: "medium",
    description: "Customer is requesting a refund for dissatisfaction.",
    cx: "1. Validate order details.<br>2. Confirm issue type.<br>3. Apply refund policy.<br>4. Document in ticket.",
    tree: "Customer Requests → Refund",
    treeCx: "Refund processed"
  }
],
      rider: [
        {
          case: "Unreachable Customer",
          type: 'Unreachable',
          urgency: 'medium',
          description: "The DA arrived at the customer’s door or compound gate, but the customer did not open the door or answer phone calls.",
          cx: "1. Ask for the order number.<br>2. Check it on Yelo.<br>3. Check the tickets first. (We can ask the DA to wait on hold until we call the customer and get back to him).<br>4. Report the ticket on freshdesk and add a note in the ticket with full details.<br>5. The cx agent must call the customer 3 trials within 7 minutes.<br>• If the customer answers: validate with them that the DA tried to call to deliver the order but received no response.<br> • If the customer confirms, mark the ticket as valid.<br>• If the customer denies being called, mark the ticket as invalid.<br>• If the customer does not answer after three attempts: cancel the order and send an “unreachable” SMS to the customer, including a refund if payment was made by credit card.",
          tree: "Internal Request- Riders Support- Unreachable Customer",
          treeCx: "Order Canceled (in case DA refused to deliver).<br> Customer informed (in case DA agreed to deliver)."
        },
        {
          case: "Out of Zone Address",
          type: 'Out of zone',
          urgency: 'medium',
          description: "The customer’s delivery address is outside the DA’s serviceable delivery zone, causing delays or potential cancellation.",
          cx: "1. The CX agent will check the order ID and create a ticket.<br>2. They will first attempt to handle the DA and request delivery as an exception.<br>3. The agent will then call the customer to inform them that their current address is out of zone but will be delivered today as a one-time exception.<br>4. If the DA refuses to deliver, we will cancel the order, choose the reason on Yelo (e.g., Fake Customer) and then inform the customer.",
          tree: "Internal Request- Riders Support- Out of Zone Address",
          treeCx: "Order Canceled (in case DA refused to deliver).<br>Customer informed (in case DA agreed to deliver)."
        },
		{
		  case: "Restaurant Delay While Dispatch",
		  type: 'Restaurant Delay While Dispatch',
		  urgency: 'medium',
		  description: "The DA is waiting at the restaurant for the order, but dispatch is delayed (handover not happening on time).",
		  cx: "•Ask for the order number<br>•Check it on Yelo.<br>•Report the ticket on freshdesk and add a note in the ticket with full details.<br>•Call the restaurant to confirm the estimated time for dispatching the order to the DA and check for any issues or high volume causing the delay<br>•Notify the DA of the ETA, and Send Delay SMS to customer to be informed of the delay<br>•If the restaurant delay is due to high order volume, request that the restaurant set themselves as busy to prevent future delays. (We can offer to set the restaurant as busy when we have access) (if the DA called within the preperation time > CX validation: invalid - action: DA handled).",
		  tree: "Internal Request- Riders Support- Restaurant Delay While Dispatch",
		  treeCx: "Handled with DA and Restaurant + Customer Informed"
		},
		{
		  case: "Order Package Messy",
		  type: 'Order Package Messy',
		  urgency: 'medium',
		  description: "The DA refuses to receive the order upon delivery due to messy packaging eg, spilled sauce or items on the bag or the order packaging is not properly sealed or is messy when handed to the DA, potentially causing food spillage.",
		  cx: "•Ask for the order number.<br>•Check it on Yelo.<br>•Report the ticket on freshdesk and add a note in the ticket with full details.<br>•Identify the issue with the packaging.<br>•Call the restaurant and attempt to resolve the situation to prevent a negative customer experience.<br>•If the restaurant refuses to cooperate, route the case to the Account Managers for escalation.",
		  tree: "Internal Request- Riders Support- Order Package Messy",
		  treeCx: "Restaurant Handled (In case restauarant cooperated) <br> No Action (in case restaurant refused) "
		},
        {
          case: "Customer Refuses to Receive",
          type: 'Customer Refuses to Receive',
          urgency: 'urgent',
          description: "The customer refuses to accept the order upon delivery due to dissatisfaction, wrong items, or other reasons.",
          cx: "•Ask for the order number.<br>•Check it on Yelo.<br>•The CX agent will check the order ID and create a ticket. They will call the customer to understand the reason for not receiving the order and attempt to handle the situation.<br>•If the customer insists on cancellation, the agent will proceed with cancellation, record or select the cancellation reason in Yelo, and inform the DA of the cancellation.<br>",
          tree: "Internal Request- Riders Support- Customer Refuses to Receive",
          treeCx: "DA Handled"
        },
        {
          case: "Customer challenges with payment ",
          type: 'Close By 0',
          urgency: 'medium',
          description: "The customer declines to pay for the order in Cash-on-Delivery (COD) cases, leaving the DA unable to complete the handover.",
          cx: "•Ask for the order number.<br>•Check it on Yelo.<br>•Report the ticket on freshdesk and add a note in the ticket with full details.<br>•Call the customer to understand why the order value hasn't been paid and explain the policy that a negative amount will be added to their account, potentially preventing future orders until the balance is settled using the top-up feature.<br>•If the customer agrees, Inform the DA to leave and apply the negative amount to the customer's account.<br>•Document the collected amount by the DA versus the actual amount for Karam to settle later.<br>•Route the ticket to the Live OPS team after confirming with both the customer and rider. (We post on cx liveops channel on slack for now)<br>•If the customer requests a cancellation instead, proceed with the cancellation, record or select the cancellation reason in Yelo, and inform the DA of the cancellation.",
          tree: "Internal Request- Riders Support- Customer challnages with payment ",
          treeCx: "DA Handled (in case negative balance will be added).<br>Order canceled (in case order will be canceled)."
        },
        {
          case: "Customer Inappropriate Attitude",
          type: 'Customer Inappropriate Attitude',
          urgency: 'urgent',
          description: "The DA reports the customer’s unprofessional, abusive, or disrespectful behavior during delivery.",
          cx: "•Ask for the order number.<br>•Check it on Yelo.<br>•Report the ticket on freshdesk and add a note in the ticket with full details.<br>•Apologize to the DA and attempt to handle the situation by asking the DA to deliver the order.<br>•Call the customer to understand what is the issue and take the necessary action. (if the DA is not handled we need to report to liveops through slack channel cx-liveops for now)",
          tree: "Internal Request- Riders Support- Customer Inappropriate Attitude",
          treeCx: "DA Handled"
        },
        {
          case: "Customer Requests to Be Called by CX",
          type: 'Customer Requests to Be Called by CX',
          urgency: 'medium',
          description: "The customer requests direct contact from CX (e.g., clarification about order, or issue order).",
          cx: "•Ask for the order number.<br>•Check it on Yelo.<br>•Report the ticket on freshdesk and add a note in the ticket with full details.<br>•Assign the ticket to the outbound team to call the customer and take the needed action<br>",
          tree: "Internal Request- Riders Support- Customer Requests to Be Called by CX",
          treeCx: "-"
        },
        {
          case: "Customer Requests Cancellation While En Route",
          type: 'Customer Requests Cancellation While En Route',
          urgency: 'urgent',
          description: "The customer asks to cancel the order after the DA has already picked it up and is on the way.",
          cx: "•Ask for the order number.<br>•Check it on Yelo.<br>•Report the ticket on freshdesk and add a note in the ticket with full details.<br>•Call the customer to understand the reason for the cancellation and try to resolve the situation.<br>•If the customer insists on canceling, proceed with the cancellation,select the cancellation reason in Yelo, and inform the DA to move <br>(If the case is routed from the catting team, should be assigned to the outbound team)",
          tree: "Internal Request- Riders Support- Customer Requests Cancellation While En Route",
          treeCx: "Order Canceled (in case customer insists on canceling).<br>No action (in case order will be delivered normally)."
        },
        {
          case: "Live OPS Assistance -DA Bike Breakdown",
          type: 'Bike Breakdown',
          urgency: 'medium',
          description: "The DA’s motorcycle, bicycle, or car breaks down during delivery, preventing them from completing the order.",
          cx: "-Ask for the order number.<br>-Check it on Yelo.<br>-Report the ticket on freshdesk and add a note in the ticket with full details.<br>-Route the case to Live OPS, who will manage the DA or reassign a new DA and for further investigation, then send delay SMS to the customer.. (we report to liveops on the slack channel cx-liveops for now)",
          tree: "Internal Request- Riders Support- Live OPS Assistance",
          treeCx: "SMS sent"
        },
        {
          case: "Live OPS Assistance",
          type: 'DA Request',
          urgency: 'urgent',
          description: "Any request from the DA related to Live OPS",
          cx: "-Check if the issue is related to the DA or to an order.<br>-Ask for the order number.<br>-Inform the DA that their issue will be reported to the Live OPS team.<br>-Route the ticket to Live OPS.<br>*Any issues unrelated to CX (e.g., DA is sick, DA wants to end their shift early, etc.) should also be routed directly to Live OPS. (we report to liveops on the slack channel cx-liveops for now)",
          tree: "Internal Request- Riders Support- Live OPS Assistance",
          treeCx: "No Action"
        }
      ],
      restaurant: [
        { case: "DA is late for pick-up", type: 'DA is late for pick-up', urgency: 'urgent', description: "The Delivery Agent has not arrived at the restaurant within the expected time window, causing a delay in food handover.", cx: "-Ask for the order number.<br>-Check it on Yelo.<br>-Create a ticket.<br>-Check the DA’s location on the map.<br>-Call the DA to confirm the estimated delivery time to the restaurant.<br>-Notify the restaurant with the ETA.", tree: "Internal Request- Resturant Support- DA is late for pick-up", treeCx: "Resturant Handled" },
        { case: "DA refused to receive order", type: 'DA refused to receive order', urgency: 'medium', description: "The DA reaches the restaurant but refuses to accept or pick up the assigned order, resulting in potential order cancellation or reassignment.", cx: "-Ask for the order number.<br>-Check it on Yelo.<br>-Create a ticket and call the DA to determine the reason for any issues.<br>-If the DA refuses to deliver, route the case to Live OPS, who will manage the DA or reassign a new DA. (through slack channel now cx-liveops)<br>-If the DA agrees to deliver without delay, no further action is needed.<br>-If a new DA is reassigned (which may cause a delay), send SMS to the customer. (we need to get back to the restautrant to update them with the action that will be taken)", tree: "Internal Request- Resturant Support- DA refused to receive order", treeCx: "Handled with DA and Resturant + Customer Informed" },
        { case: "Electricity Issue", type: 'Electricity Issue', urgency: 'urgent', description: "The restaurant is unable to prepare food due to a power outage, impacting order fulfillment.", cx: "-Create a ticket and mark the restaurant as busy. (for now will send on slack bfa-cx-day-savers to ask them to set the restaurant as busy as we don't have access yet)<br>-Coordinate with the restaurant to obtain an ETA for when the issue will be resolved.<br>-Request the restaurant to complete ongoing orders and cancel those not yet started on their behalf.<br>-Create a cancellation ticket with a detailed reason and route it to the outbound team. (In case there is only one order, inbound team will create a cancellation ticket that would be assigned to the OB to call the customer / if there are more than one order, will create one ticket to the outbound team to cancel these orders and create a cancelation ticket for each order)<br>*CX Oubtound Action*<br>-Read the reason, call the customer, and inform them that the order will be canceled.<br>*If the order was paid by -Visa, inform the customer of our authorization and capture payment policy and offer a 200 LE compensation.<br>-Create a \"Wallet Refund\" ticket for the compensation.", tree: "Internal Request- Resturant Support- Electricity Issue", treeCx: "Resturant Handled" },
        { case: "Internet Issue", type: 'Internet Issue', urgency: 'medium', description: "The restaurant cannot receive or confirm orders due to internet connectivity problems.", cx: "-Create a ticket and mark the restaurant as busy. (for now will send on slack bfa-cx-day-savers to ask them to set the restaurant as busy as we don't have access yet)<br>-Coordinate with the restaurant to obtain an ETA for when the issue will be resolved. (In case of landline/internet issue and not SIM card issue)<br>-Request the restaurant to complete ongoing orders and cancel those not yet started on their behalf.<br>-Create a cancellation ticket with a detailed reason and route it to the outbound team. (In case there is only one order, inbound team will create a cancellation ticket that would be assigned to the OB to call the customer / if there are more than one order, will create one ticket to the outbound team to cancel these orders and create a cancelation ticket for each order)<br>*CX Oubtound Action*<br>-Read the reason, call the customer, and inform them that the order will be canceled.<br>*If the order was paid by -Visa, inform the customer of our authorization and capture payment policy and offer a 200 LE compensation.<br>-Create a \"Wallet Refund\" ticket for the compensation.", tree: "Internal Request- Resturant Support- Internet Issue", treeCx: "Resturant Handled" },
        { case: "Kitchen Maintenance", type: 'Kitchen Maintenance', urgency: 'urgent', description: "The restaurant is unable to prepare food due to issues with kitchen equipment (e.g., grill, fryer, oven, or other essential tools) requiring maintenance or repair, which temporarily disrupts order fulfillment.", cx: "-Create a ticket and mark the restaurant as busy. (for now will send on slack bfa-cx-day-savers to ask them to set the restaurant as busy as we don't have access yet)<br>-Coordinate with the restaurant to obtain an ETA for when the issue will be resolved.<br>-Request the restaurant to complete ongoing orders (if possible) and cancel those not yet started on their behalf.<br>-Create a cancellation ticket with a detailed reason and route it to the outbound team. (In case there is only one order, inbound team will create a cancellation ticket that would be assigned to the OB to call the customer / if there are more than one order, will create one ticket to the outbound team to cancel these orders and create a cancelation ticket for each order)<br>*CX Oubtound Action*<br>-Read the reason, call the customer, and inform them that the order will be canceled.<br>*If the order was paid by -Visa, inform the customer of our authorization and capture payment policy and offer a 200 LE compensation. <br>-Create a \"Wallet Refund\" ticket for the compensation.", tree: "Internal Request- Resturant Support- Kitchen Maintenance", treeCx: "Resturant Handled" },
        { case: "System Crash", type: 'System Crash', urgency: 'medium', description: "The restaurant’s POS or ordering system fails “Tablet or SIM Card”, preventing them from receiving or processing orders.", cx: "-Create a ticket and set the restaurant status to busy, then assign the ticket to the Onboarding Team and mention the account managers in the note for visability. (for now will send on slack bfa-cx-day-savers to ask them to set the restaurant as busy as we don't have access yet)<br>-Coordinate with the restaurant to get the exact system issue to inform the account manager<br>-Request the restaurant to complete ongoing orders (if possible) and cancel those not yet started on their behalf.<br>-Create a cancellation ticket with a detailed reason and route it to the outbound team.(In case there is only one order, inbound team will create a cancellation ticket that would be assigned to the OB to call the customer / if there are more than one order, will create one ticket to the outbound team to cancel these orders and create a cancelation ticket for each order)<br>*CX Oubtound Action*<br>-Read the reason, call the customer, and inform them that the order will be canceled.<br>*If the order was paid by -Visa, inform the customer of our authorization and capture payment policy and offer a 200 LE compensation.<br>-Create a \"Wallet Refund\" ticket for the compensation.", tree: "Internal Request- Resturant Support- System Crash", treeCx: "Resturant Handled" },
        { case: "Unavailable Menu Item – Stock Issue", type: 'Can be Replaced', urgency: 'urgent', description: "A menu item is listed as available but is actually out of stock at the restaurant, leading to customer dissatisfaction.", cx: "-Ask for the order number.<br>-Check it on Yelo.<br>-Create a ticket and mark the item as unavailable. (Will ask the reastaurant to take the action from their side if possible - if not, will send on slack channcel bfa-cx-day-savers)<br>-Call the customer to confrim with them and proceed with the needed compensation. (if the customer wants to cancel the order, we need to create a cancelation ticket and get back to the restaurant to inform them)", tree: "Internal Request- Resturant Support- Unavailable Menu Item – Stock Issue", treeCx: "Item Marked Unavailable + Customer Informed" },
        { case: "Duplicate Order", type: 'Duplicate Order', urgency: 'medium', description: "The same order is received multiple times by the restaurant due to a system glitch or error, creating confusion.", cx: "-Ask for the order number.<br>-Check it on Yelo.<br>-Contact the customer and check if they want both orders or only one.<br>-If the customer wants one of them, cancel the other and close the ticket.<br>-If they want both, contact the restaurant to prepare both items.<br>(if the customer wants to cancel the order, we need to create a cancelation ticket and get back to the restaurant to inform them)", tree: "Internal Request- Resturant Support- Duplicate Order", treeCx: "Order canceled (In case one of them is canceled).<br>Restaurant Handled (in case customer wants both orders)." },
        { case: "DA rude behavior", type: 'With The Restaurant', urgency: 'urgent', description: "Restaurant staff reports unprofessional, disrespectful, or aggressive behavior by the DA during pickup.", cx: "-Ask for the order number.<br>-Check it on Yelo.<br>-Create a ticket, apologize to the restaurant, and assure them that the issue with the DA will be escalated.<br>-Route the case to Live OPS, who will manage the DA or reassign a new DA. (through slack channel for now cx-liveops)<br>-If a delay is expected due to reassignment, should sent Delay SMS", tree: "Internal Request- Resturant Support- DA rude behavior", treeCx: "Handled with DA and Restaurant + Customer Informed" },
        { case: "DA misuse of food", type: 'DA misuse of food', urgency: 'medium', description: "The restaurant reports or suspects that the Delivery Agent mishandled the food after collection, such as eating part of the order, placing food on the ground, or compromising food safety in any way.", cx: "-Create a ticket, apologize to the restaurant, and reassure them that the issue with the rider will be escalated.<br>-Route the ticket to the liveOps team to take an action with the DA. (through slack channel for now cx-liveops)", tree: "Internal Request- Resturant Support- DA misuse of food", treeCx: "Resturant Handled" },
        { case: "Pricing Issue or Description or Photo", type: 'Pricing Issue or Description or Photo', urgency: 'urgent', description: "The restaurant reports an error in the displayed menu content, such as incorrect pricing, inaccurate item descriptions, or wrong/missing photos. These issues are related to the Content Team and may affect customer expectations and order accuracy.", cx: "-Create a ticket and reassure the restaurant that the issue will be escalated to the Content Team<br>-Route the ticket to the Content Team for resolution within the agreed SLA.<br>-Mention the Account Managers in the note for visibility (for now will send on slack channel bfa-cx-day-savers)", tree: "Internal Request- Resturant Support- Pricing Issue or Description or Photo", treeCx: "No action Needed" },
        { case: "Rider Picked Up wrong Order", type: 'Rider Picked Up wrong Order', urgency: 'medium', description: "The restaurant reports that the DA picked up wrong order and want them back for exchange before reaching the customer", cx: "-Ask for the order number.<br>-Check it on Yelo.<br>-Create a ticket and call the DA to confrim<br> • If the DA could get back to change the order, then confrim with the restruant and then Send the Delay SMS to the customer.<br> • If not, Create ticket and route it to Live OPS to re assign new DA to get the right order to deliver it for the customer and then Send the Delay SMS to the customer. (will send through slack channel cx-liveops)", tree: "Internal Request- Resturant Support- Rider Picked Up wrong Order", treeCx: "Handled with DA and Restaurant + Customer Informed (in case the DA will be back for the exchange).<br>Same action if the order will be reassigned." }
      ],
      outbound: [
        {
          content: `
            <div class="document-view">
              <h2>Responsibilities</h2>
              <p>The Outbound Team will handle the following cases:</p>
              <ol>
                <li>4- and 5-star ratings with comments</li>
                <li>Customer requests for a call (from any team)</li>
                <li>High-value tickets</li>
                <li>Late order tickets</li>
              </ol>

              <h2>1. 4- and 5-Star Ratings with Comments</h2>
              <ul>
                <li>Process will follow the same model as the Supermarket team.</li>
                <li>Agents will review the customer’s comments and take appropriate follow-up actions.</li>
              </ul>

              <h2>2. Customer Requests for a Call</h2>
              <ul>
                <li>Customer call-back requests (from any team) will be handled by the Outbound Team.</li>
                <li>Follow-up process will be the same as the Supermarket model.</li>
              </ul>
              <h3>Handling Notes:</h3>
              <ul>
                <li>A customer complaint ticket must always be submitted.</li>
                <li>If the order is from Breadfast Coffee or Breadfast Kitchen:
                  <ul>
                    <li>Proceed with pickup, if needed.</li>
                    <li>Route the case to Pending QA Update, if needed investigation.</li>
                    <li>Compensate the customer and follow the same sequence as the Supermarket model.</li>
                  </ul>
                </li>
                <li>For all other restaurants:
                  <ul>
                    <li>Submit the complaint.</li>
                    <li>Compensate the customer.</li>
                    <li>Close the ticket.</li>
                  </ul>
                </li>
              </ul>

              <h2>3. High-Value Order Tickets</h2>
              <p>A ticket is triggered when the order value is above 2,500 EGP.</p>
              <h3>Process:</h3>
              <ol>
                <li>Call the customer to confirm: Address, Order amount, Confirmation that the customer still needs the order.</li>
                <li>Once confirmed, call the restaurant to start preparing the order.</li>
                <li>If the customer does not answer after 2 call attempts (2nd trial after 2 minutes) / the valid trial should be ringing "not busy":
                  <ul>
                    <li>Cancel the order in Yelo with the appropriate cancellation reason (fake order).</li>
                    <li>Send this SMS to the customer:
                      <div class="sms-box">“We tried to call you twice to confirm your order. However, since we did not receive a response, your order has been cancelled. Please reach out to Breadfast Support through the app if you have any questions or concerns.”</div>
                    </li>
                  </ul>
                </li>
                <li><strong>Priority:</strong> These tickets are high priority since restaurants will not start preparation until confirmation is received.</li>
              </ol>

              <h2>4. Late Order Tickets</h2>
              <p>A ticket is triggered when an order is delayed by 5 minutes or more after the agreed delivery time. (This is based on the expected time shown on switcher NOT YELO - if it's completed but late for less than 5 minutes, our action will be only calling and handling the customer)</p>
              <h3>Process (if late for more than 5 minutes):</h3>
              <ol>
                <li>Check if the order has been delivered or not.</li>
                <li>Call the rider or restaurant (based on order status) to confirm the expected delivery time.</li>
                <li>Call the customer to apologize for the delay and offer compensation based on the delay duration:</li>
              </ol>
              
              <table class="comp-policy-table">
                <thead>
                  <tr>
                    <th>Delay Duration</th>
                    <th>Compensation Offered</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Short Delay (5–10 min)</td>
                    <td><span class="badge-percent">25% of order amount</span></td>
                  </tr>
                  <tr>
                    <td>Mid Delay (15–20 min)</td>
                    <td><span class="badge-percent">50% of order amount</span></td>
                  </tr>
                  <tr>
                    <td>Extreme Delay (25–30 min)</td>
                    <td><span class="badge-full-refund">100% refund</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          `
        }
      ],
      nps: [
        {
          content: `
            <div class="document-view">
              <h2>1. Ticket Notification:</h2>
              <ul>
                <li>The Follow-Up Team receives a ticket 1 hour after order completion.</li>
              </ul>

              <h2>2. Please enter the following data in each ticket:</h2>
              <ul>
                <li>Agent adds the customer details and fills in the NPS sheet with the following fields:
                  <ul>
                    <li>Ticket ID</li>
                    <li>Order ID</li>
                    <li>Customer ID</li>
                    <li>Restaurant HRID</li>
                    <li>DA HRID</li>
                    <li>Month</li>
                    <li>Date</li>
                    <li>Agreed to Record</li>
                    <li>NPS Question: “On a scale from 0 to 10, how likely are you to recommend Breadfast restaurant delivery to a friend or colleague?”</li>
                    <li>NPS Score Category</li>
                    <li>Main reason for the score</li>
                    <li>How easy was it to place your order?</li>
                    <li>Is there anything that could have made the ordering experience better?</li>
                    <li>Were there any features you expected but didn’t find? If yes, what are they?</li>
                    <li>How satisfied were you with the delivery speed, accuracy, and rider experience?</li>
                    <li>What could we improve about your delivery experience?</li>
                    <li>How satisfied were you with the temperature and quality of your food upon delivery?</li>
                    <li>How do you feel about the variety of restaurants available on Breadfast today?</li>
                    <li>Are there specific restaurants you’d like us to add?</li>
                  </ul>
                </li>
              </ul>

              <h2>3. Duplication Check</h2>
              <ul>
                <li>On the next day, search using the customer number to confirm if the customer has already been called before, to avoid disturbing them with repeated follow-ups.</li>
              </ul>

              <h2>4. NPS & Compensation Logging</h2>
              <ul>
                <li>Submit the NPS score in the tree.</li>
                <li>Add the compensation amount (if offered) in line with the Compensation Guidelines based on the NPS score.</li>
              </ul>

              <h2>5. Complaint Handling</h2>
              <ul>
                <li>If the customer raises a complaint, create a separate complaint ticket to ensure proper handling and tracking.</li>
              </ul>
            </div>
          `
        }
      ],
      all_numbers: [
        {
          case: "Restaurant Contact List",
          dropdownTitle: "Numbers",
          content: "<strong>KFC:</strong> 19019<br><strong>Pizza Hut:</strong> 19000<br><strong>McDonald's:</strong> 19991"
        }
      ],
      main_process: [
        { 
          content: `
     		 <div class="viewer-search-bar">
       		 <input type="text" id="compensationSearch" placeholder="Search in compensation table...">
     		 </div>
     		 <table class="comp-table">
     		   <thead>
                <tr>
                   <th>Complaint Type</th>
                  <th>Description</th>
                  <th>Needed Action / Information</th>
                  <th>Recommended Compensation</th>
                  <th>Notes</th>
                  <th>Category</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Bad Quality Food</strong></td>
                  <td>Not fresh food, undercooked, overcooked, spoiled.</td>
                  <td>📷 Picture</td>
                  <td><span class="badge refund">Refund</span> 100% refund of the item + Delivery Fees</td>
                  <td class="note">Request photo evidence when possible.</td>
                  <td><span class="category">Food Quality</span></td>
                </tr>
                <tr>
                  <td><strong>Wrong Temperature (Cold/Hot) Food</strong></td>
                  <td>Cold food when it should be hot; melted/damaged cold items.</td>
                  <td>—</td>
                  <td><span class="badge replacement">Replacement</span> Replacement order OR 100% refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Food Quality</span></td>
                </tr>
                <tr>
                  <td><strong>Wrong Order Delivered</strong></td>
                  <td>Completely different dishes/items.</td>
                  <td>—</td>
                  <td><span class="badge replacement">Replacement</span> Replacement OR 100% refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Order Issue</span></td>
                </tr>
                <tr>
                  <td><strong>Missing Items</strong></td>
                  <td>Main item missing.</td>
                  <td>—</td>
                  <td><span class="badge replacement">Replacement</span> Replacement OR 100% refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Order Issue</span></td>
                </tr>
                <tr>
                  <td><strong>Side Item Missing</strong></td>
                  <td>Side item that should come with the main item (e.g., sauce).</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> 30% refund of item + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Order Issue</span></td>
                </tr>
                <tr>
                  <td><strong>Add-on Missing</strong></td>
                  <td>Paid add-on not provided.</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> Full refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Order Issue</span></td>
                </tr>
                <tr>
                  <td><strong>Orders Cancelled Due to DA or Restaurant Issues</strong></td>
                  <td>Cancelled by DA or Restaurant.</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> Full Refund + 100–200 EGP for inconvenience</td>
                  <td>—</td>
                  <td><span class="category">Operational</span></td>
                </tr>
                <tr>
                  <td><strong>Late Orders</strong></td>
                  <td>Late above 15 minutes ETA.</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> Full refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Operational</span></td>
                </tr>
                <tr>
                  <td><strong>Delivery Agent Misconduct</strong></td>
                  <td>Inappropriate attitude / mishandling food.</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> 50% refund; theft/harassment = 100% + escalation</td>
                  <td>—</td>
                  <td><span class="category">Operational</span></td>
                </tr>
                <tr>
                  <td><strong>Smashed / Spilled</strong></td>
                  <td>Food smashed or spilled during handling/delivery.</td>
                  <td>—</td>
                  <td><span class="badge replacement">Replacement</span> Replacement OR 100% refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Food Quality</span></td>
                </tr>
                <tr>
                  <td><strong>Portion Size Issues</strong></td>
                  <td>Smaller than advertised/paid for.</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> 50% refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Food Quality</span></td>
                </tr>
                <tr>
                  <td><strong>Out-of-Stock after accepting order</strong></td>
                  <td>Restaurant later notifies item is out-of-stock.</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> Full refund + Delivery Fees</td>
                  <td>—</td>
                  <td><span class="category">Operational</span></td>
                </tr>
                <tr>
                  <td><strong>Technical / System Errors</strong></td>
                  <td>Duplicate charge, no order received.</td>
                  <td>—</td>
                  <td><span class="badge refund">Refund</span> Full Refund + 100 EGP for inconvenience</td>
                  <td>—</td>
                  <td><span class="category">System</span></td>
                </tr>
                <tr>
                  <td><strong>Goodwill Compensation (CSAT Recovery)</strong></td>
                  <td>Minor issue / repetitive complaints.</td>
                  <td>—</td>
                  <td><span class="badge fixed">Fixed</span> 50% refund OR 100–200 EGP</td>
                  <td>—</td>
                  <td><span class="category">Goodwill</span></td>
                </tr>
                <tr>
                  <td><strong>NPS Recovery – Mild</strong></td>
                  <td>First-time NPS drop, minor complaint.</td>
                  <td>—</td>
                  <td><span class="badge fixed">Fixed</span> 100 EGP</td>
                  <td>—</td>
                  <td><span class="category">Goodwill</span></td>
                </tr>
                <tr>
                  <td><strong>NPS Recovery – Moderate</strong></td>
                  <td>Clear failure: late order, missing items, etc.</td>
                  <td>—</td>
                  <td><span class="badge fixed">Fixed</span> 200 EGP</td>
                  <td>—</td>
                  <td><span class="category">Goodwill</span></td>
                </tr>
                <tr>
                  <td><strong>NPS Recovery – Severe</strong></td>
                  <td>High churn risk, repeated issues.</td>
                  <td>—</td>
                  <td><span class="badge fixed">Fixed</span> 300 EGP</td>
                  <td>—</td>
                  <td><span class="category">Goodwill</span></td>
                </tr>
                <tr>
                  <td><strong>Food Safety – Moderate</strong></td>
                  <td>Foreign object, illness complaints, medical proof.</td>
                  <td>📷 Picture</td>
                  <td><span class="badge refund">Refund</span> Full Refund + 300 EGP</td>
                  <td class="note">Request photo evidence when possible.</td>
                  <td><span class="category">Food Safety</span></td>
                </tr>
              </tbody>
            </table>
          ` 
        }
      ]
    };

    
function renderCases(cases, title, type = 'case'){
  viewerTitle.textContent = title;
  if (!cases || cases.length === 0){
    viewerContent.innerHTML = "<p class='muted'>No cases found.</p>";
    return;
  }

  let contentHTML = '';

  // Special style for Products
  if (title.includes("Products")) {
    contentHTML = '<div class="product-list">' +
      cases.map((c, idx) => `
        <div class="product-card">
          <div class="product-card-header">
            <h3><span class="icon">${c.type.includes("Food") ? "🍔" : "📦"}</span>${c.case}</h3>
            <span class="urgency-badge ${(c.urgency||"normal").toLowerCase()}">${c.urgency||"Normal"}</span>
          </div>
          <span class="product-tag">${c.type}</span>
          <p class="product-desc">${c.description||"No description"}</p>
          <button onclick="openModal('productModal${idx}')">View Details</button>
        </div>

        <div id="productModal${idx}" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <span>${c.case}</span>
              <span class="modal-close" onclick="closeModal('productModal${idx}')">&times;</span>
            </div>
            <div class="modal-body">
              <h4>Case Handling Steps</h4>
              <p>${c.cx||"No action steps"}</p>

              <h4>Compensation Needed</h4>
              <p>${c.treeCx||"No compensation info"}</p>

              <h4>Ticket Tree</h4>
              <p>${c.tree||"No tree data"}</p>
            </div>
          </div>
        </div>
      `).join('') +
    '</div>';
  }
  else if (type === 'document') {
    contentHTML = `<div class="document-view">${cases.map(c => c.content || "").join('')}</div>`;
  } else if (type === 'table') {
    contentHTML = cases.map(c => c.content || "").join('');
  } else if (type === 'single_dropdown') {
    contentHTML = '<div class="case-list">' +
      cases.map(c => `
        <div class="case-card open">
          <div class="case-header" style="cursor: default;">${c.case}</div>
          <div class="case-body" style="max-height: 1500px;">
            <div class="dropdown open">
              <div class="dropdown-header" style="cursor: default;">${c.dropdownTitle || 'Details'} <span class="dropdown-arrow" style="transform: rotate(90deg);">▶</span></div>
              <div class="dropdown-body" style="max-height: 500px; padding: 12px 16px;">
                ${c.content || "No content defined."}
              </div>
            </div>
          </div>
        </div>
      `).join('') +
    '</div>';
  } else { // Default 'case' type
    contentHTML = '<div class="case-list">'+
      cases.map(c => `
        <div class="case-card">
          <div class="case-header urgency-${(c.urgency || 'normal').toLowerCase()}">
            <div class="case-header-title">
              <span>${c.case}</span>
              ${c.type ? `<span class="case-tag type-${(c.type || '').replace(/ /g, '-').toLowerCase()}">${c.type}</span>` : ''}
            </div>
            <span class="arrow">▶</span>
          </div>
          <div class="case-body">
            <div class="dropdown">
              <div class="dropdown-header">ℹ️ Description <span class="dropdown-arrow">▶</span></div>
              <div class="dropdown-body">${c.description||"No description"}</div>
            </div>
            <div class="dropdown">
              <div class="dropdown-header">🛠️ CX Agent Action Steps <span class="dropdown-arrow">▶</span></div>
              <div class="dropdown-body">${c.cx||"No action"}</div>
            </div>
            <div class="dropdown">
              <div class="dropdown-header">🌳 Tree <span class="dropdown-arrow">▶</span></div>
              <div class="dropdown-body">${c.tree||"No tree data"}</div>
            </div>
            <div class="dropdown">
              <div class="dropdown-header">⬆️ CX Actions <span class="dropdown-arrow">▶</span></div>
              <div class="dropdown-body">${c.treeCx||"No tree CX action"}</div>
            </div>
          </div>
        </div>
      `).join('')+
    '</div>';
  }

  viewerContent.innerHTML = contentHTML;

  if (type === 'table') {
    const searchInput = document.getElementById('compensationSearch');
    const table = viewerContent.querySelector('.comp-table');
    if (searchInput && table) {
      const rows = table.querySelectorAll('tbody tr');
      searchInput.addEventListener('input', () => {
        const query = searchInput.value.toLowerCase();
        rows.forEach(row => {
          const rowText = row.textContent.toLowerCase();
          row.style.display = rowText.includes(query) ? '' : 'none';
        });
      });
    }
  }

  if (type === 'case') {
    document.querySelectorAll('.case-header').forEach(header => {
      header.addEventListener('click', () => {
        const card = header.parentElement;
        card.classList.toggle('open');
        if (!card.classList.contains('open')) {
          card.querySelectorAll('.dropdown').forEach(d => d.classList.remove('open'));
        }
      });
    });

    document.querySelectorAll('.dropdown-header').forEach(header => {
      header.addEventListener('click', (e) => {
        e.stopPropagation();
        const parent = header.parentElement;
        parent.classList.toggle('open');
      });
    });
  }
}
function removeAllActiveClasses() {
        categories.forEach(c => c.classList.remove('active'));
        complaints.forEach(c => c.classList.remove('active'));
        numbers.forEach(n => n.classList.remove('active'));
        processes.forEach(p => p.classList.remove('active'));
    }

    categories.forEach(cat => {
      cat.addEventListener('click', () => {
        removeAllActiveClasses();
        cat.classList.add('active');
        const renderType = cat.dataset.renderType || 'case';
        renderCases(demoCases[cat.dataset.cat]||[], cat.innerText, renderType);
      });
    });

    complaints.forEach(comp => {
      comp.addEventListener('click', () => {
        removeAllActiveClasses();
        comp.classList.add('active');
        renderCases(demoCases[comp.dataset.comp]||[], comp.innerText + " Complaints", 'case');
      });
    });

    numbers.forEach(num => {
      num.addEventListener('click', () => {
        removeAllActiveClasses();
        num.classList.add('active');
        renderCases(demoCases[num.dataset.num]||[], "Restaurant " + num.innerText, 'single_dropdown');
      });
    });

    processes.forEach(proc => {
      proc.addEventListener('click', () => {
        removeAllActiveClasses();
        proc.classList.add('active');
        renderCases(demoCases[proc.dataset.proc]||[], "Compensation Process", 'table');
      });
    });

    function setupToggle(toggleId, boxId){
      const toggle = document.getElementById(toggleId);
      const box = document.getElementById(boxId);
      const arrow = toggle.querySelector('.arrow');
      toggle.addEventListener('click', () => {
        box.classList.toggle('open');
        if(box.classList.contains('open')){
          box.style.maxHeight = box.scrollHeight + "px";
          arrow.style.transform = "rotate(90deg)";
        } else {
          box.style.maxHeight = "0px";
          arrow.style.transform = "rotate(0deg)";
        }
      });
    }

    setupToggle('catToggle','categories');
    setupToggle('compToggle','complaints');
    setupToggle('numToggle','numbersBox'); 
    setupToggle('compProcessToggle','CompensationProcessBox'); 

    const sidebarSearch = document.getElementById('sidebarSearch');
    sidebarSearch.addEventListener('input', () => {
      const query = sidebarSearch.value.toLowerCase();
      
      [...document.querySelectorAll('.cat, .comp, .num, .proc')].forEach(item => {
        item.style.display = item.innerText.toLowerCase().includes(query) ? 'block' : 'none';
      });
      
      [...document.querySelectorAll('.case-card, .comp-table tbody tr')].forEach(item => {
        if (item.classList.contains('case-card')) {
            const header = item.querySelector('.case-header');
            if (header) {
              const title = header.innerText.toLowerCase();
              item.style.display = title.includes(query) ? 'block' : 'none';
            }
        } else { // This is a table row
            const text = item.innerText.toLowerCase();
            item.style.display = text.includes(query) ? '' : 'none';
        }
      });
    });
  
function openModal(id) {
  document.getElementById(id).style.display = 'flex';
}
function closeModal(id) {
  document.getElementById(id).style.display = 'none';
}
window.onclick = function(event) {
  document.querySelectorAll('.modal').forEach(modal => {
    if (event.target === modal) modal.style.display = 'none';
  });
};

</script>
</body>
</html>
}